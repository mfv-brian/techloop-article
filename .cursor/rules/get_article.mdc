# Single Article Processing Rules

## Execution Mode
- **Automatic Execution**: All commands (directory creation, file downloads, image processing) should execute automatically without asking for user approval
- **No Confirmation Required**: Proceed with all operations immediately when requested
- **Error Handling**: Continue with other tasks if individual operations fail

## Directory Structure
- Create a new directory in `articles/` with format: `A-xxxx` (where xxxx ranges from 0001 to 9999)
- Use the next available number in sequence
- Each article gets its own directory

## Article Processing Workflow

### Step 0: Batch Download Articles (REQUIRED FIRST STEP)
- **Before processing any article, ALWAYS run batch downloader first:**
  ```bash
  node batch_downloader.js
  ```
- This will:
  - Download all articles from `articles/today-articles.md`
  - Create numbered directories (A-0001, A-0002, etc.)
  - Download `raw.html` for each article
- **No image extraction or download at this step**
- **Only proceed to article processing after batch download is complete**
- Use the created directories for individual article processing

### Step 1: Structure Article Content - STRICT FORMAT REQUIREMENTS
- Using cursor to read raw.html to extract main article content
- Rewrite content in Vietnamese ONLY (no English)
- Convert US measurements to Vietnamese equivalents:
  - Inches → cm (1 inch = 2.54 cm)
  - Pounds → kg (1 pound = 0.453592 kg)
  - Miles → km (1 mile = 1.60934 km)
  - Fahrenheit → Celsius (F-32)*5/9
  - Dollars → VND (1 USD = 24,000 VND approximately)

Create `content.md` with EXACT structure:

**Title**: Vietnamese title of the article (max 150 characters)

**Summary**: Brief Vietnamese summary (2-3 sentences, max 300 characters)

**Main Content**: Full Vietnamese article with format based on article type:

#### **FOR PRODUCT REVIEW ARTICLES** - Follow existing format:

##### **Đánh Giá Sản Phẩm** (3000-6000 words - TĂNG GẤP 3 LẦN)
- Viết từ góc nhìn người dùng thực tế
- Bao gồm cảm xúc, suy nghĩ và trải nghiệm cá nhân
- Viết ở ngôi thứ nhất (tôi, mình)
- Mô tả chi tiết về sản phẩm, tính năng, trải nghiệm sử dụng
- Thêm dòng trống giữa các đoạn văn
- **Mở rộng nội dung**: Thêm chi tiết về thiết kế, chất liệu, quy trình sản xuất, so sánh với đối thủ cạnh tranh, lịch sử phát triển sản phẩm, xu hướng thị trường

##### **Phân Tích Chi Tiết** (1500-3000 words - TĂNG GẤP 3 LẦN)
- **Ưu điểm**: Liệt kê và phân tích các điểm mạnh
- **Nhược điểm**: Liệt kê và phân tích các điểm yếu  
- **Giá cả**: Đánh giá về giá trị tiền bạc
- **Đánh giá tổng thể**: Kết luận về sản phẩm/dịch vụ
- Thêm dòng trống giữa các đoạn văn
- **Mở rộng nội dung**: Thêm phân tích kỹ thuật sâu, benchmark tests, user feedback tổng hợp, expert opinions, market analysis

##### **Kết Luận và Khuyến Nghị** (600-900 words - TĂNG GẤP 3 LẦN)
- Suy nghĩ cuối cùng
- Khuyến nghị hành động cụ thể
- Thêm dòng trống giữa các đoạn văn
- **Mở rộng nội dung**: Thêm long-term assessment, future outlook, alternative recommendations, value proposition analysis

#### **FOR JOURNALISTIC/NEWS ARTICLES** - Maintain original format:
- Giữ nguyên cấu trúc và format của bài báo gốc
- Chỉ chuyển đổi ngôn ngữ sang tiếng Việt
- Chuyển đổi đơn vị đo lường theo quy định
- **TĂNG GẤP 3 LẦN: Nếu bài viết dài hơn 6000 từ, viết lại trong khuôn khổ 6000 từ**
- Giữ nguyên thông tin quan trọng và sự kiện chính
- Đảm bảo tính chính xác và khách quan của thông tin
- **Mở rộng nội dung**: Thêm background information, historical context, expert analysis, related developments, future implications

**Source Citation**: 
```
Trích dẫn nguồn: [original Gizmodo URL]
```

### Step 2: Image Selection & Download
- Trong khi đọc raw.html, xác định các ảnh thuộc bài viết (không lấy ảnh bài liên quan)
- **Ưu tiên lấy ảnh từ header/featured image của bài viết trước**
- Sau đó chọn thêm các ảnh khác từ nội dung bài viết
- Tạo danh sách 5 ảnh phù hợp nhất, ghi vào `images.txt` (1 URL mỗi dòng)
- **Sau khi đã có images.txt, chạy:**
  ```bash
  node download_images.js
  ```
- Script này sẽ tự động tải các ảnh trong images.txt về đúng thư mục bài viết
- **Giữ nguyên file raw.html - không xóa đi**
- **Xử lý lỗi**: Nếu có lỗi khi tải ảnh (404, network error, etc.), bỏ qua và tiếp tục với ảnh tiếp theo
- **Không dừng script**: Script sẽ tiếp tục chạy cho đến khi hoàn thành tất cả ảnh, báo cáo số ảnh thành công/thất bại
- Sau khi tải xong, chỉ giữ lại các ảnh đã tải thành công trong thư mục (xóa ảnh thừa nếu có)

## Format Compliance Checklist
- [ ] Tiêu đề ≤ 150 ký tự
- [ ] Tóm tắt ≤ 300 ký tự  
- [ ] **Product Reviews**: Có đầy đủ 3 phần: Đánh Giá Sản Phẩm (3000-6000 từ), Phân Tích Chi Tiết (1500-3000 từ), Kết Luận (600-900 từ)
- [ ] **Journalistic Articles**: Giữ nguyên format gốc, tối đa 6000 từ (TĂNG GẤP 3 LẦN)
- [ ] Dòng trống giữa các đoạn văn
- [ ] Chuyển đổi đơn vị đo lường
- [ ] Nội dung hoàn toàn bằng tiếng Việt
- [ ] Có trích dẫn nguồn
- [ ] 5 ảnh khác nhau được chọn từ images.txt và đã được tải về
